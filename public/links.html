<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Links</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        body {
            padding: 20px;
            background-image: url('../backgrounds/gradient-background.png');
            background-size: cover;
            background-repeat: no-repeat;
        }
        .btn {margin-top: 10px;}
        .form-control {flex: 0 1 100px;}
        #gradientHeader {
            --bg-size: 400%;
            background: linear-gradient(60deg, #1d2b64, #f8cdda, #1d2b64) 0 0 / 400% 100%;
            color: transparent;
            background-clip: text;
            animation: gradient 10s infinite linear;
            }
        #gradientButton {
            --bg-size: 400%;
            background: linear-gradient(60deg, #1d2b64, #f8cdda, #1d2b64) 0 0 / 400% 100%;
            animation: gradient 20s infinite linear;
            border: none;
        }
        @keyframes gradient {
            to {
                background-position: var(--bg-size) 0;
            }
        }
    </style>
</head>
<body>
    <header><h1><strong id="gradientHeader">Link Checker</strong></h1></header>
    <div>
        <form id="linkForm">
            <div class="form-group row">
                <label for="initialLink">Paste link here:</label>
                <div class="col-sm-3">
                    <input type="text" class="form-control" id="initialLink" name="initialLink" aria-describedby="linkHelp" placeholder="eg. https://siena.edu/">
                </div>
                <small id="linkHelp" class="form-text text-muted">Ensure you have 'https://' included.</small>
            </div>
            <button type="submit" class="btn btn-dark btn-lg" id="gradientButton">Submit</button>
          </form>
    </div>

    <script>
        const linkForm = document.getElementById('linkForm').addEventListener('submit', async function (event) {
            event.preventDefault();

            const initialLink = document.getElementById('initialLink').value;
            
            try {
                const resp = await fetch('http://localhost:8000/test/links/add', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain',
                    },
                    body: initialLink
                });

                if (!resp.ok) {
                    throw new Error('Failed to add link. Try another link.');
                }

                const result = await resp.json();
                console.log('All Links:', result.all);
                console.log('Good Links:', result.good);
                console.log('Bad Links:', result.bad);
            } catch (error) {
                console.log(error);
            }
        });















        // let BASE_URL = 'http://localhost:8000/test/links';

        // fetch(BASE_URL)
        // .then(statusCheck)
        // .then(resp => resp.json())
        // .then(appendList)
        // .catch(handleError);


        // async function statusCheck(res) {
        //     if (!res.ok) {
        //         throw new Error(await res.text());
        //     }
        //     return res;
        // }

        // function appendList(data) {
        //     const links = document.getElementById('links');
        //     data.forEach(item => {
        //         let p = document.createElement('p');
        //         p.appendChild(document.createTextNode(item));
        //         links.appendChild(p);
        //     });
        // }

        // function handleError(error) {
        //     console.log(error);
        // }
    </script>
</body>
</html>